{"remainingRequest":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/src/views/Profile.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/src/views/Profile.vue","mtime":1603071037853},{"path":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/rothasar/Documents/workspace/hamlinstreethorror/hamlinhorrorstreet-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQgeyBDb21wb25lbnQsIFZ1ZSB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwppbXBvcnQgXyBmcm9tICdsb2Rhc2gnOwoKQENvbXBvbmVudApleHBvcnQgZGVmYXVsdCBjbGFzcyBQcm9maWxlIGV4dGVuZHMgVnVlIHsKCiAgcHJpdmF0ZSBmaWxlcyA9IFtdOwoKICBwcml2YXRlIHVwbG9hZEZpbGVzID0gW107CgogIHByaXZhdGUgbWVzc2FnZSA9ICcnOwoKICBwcml2YXRlIGltZ1VSTCA9IFtdOwoKICBwcml2YXRlIHlvdXJJbWFnZXMgPSBbXTsKCiAgcHJpdmF0ZSBkZWxldGVJbWFnZUlkID0gW107CgogIHByaXZhdGUgZ2V0IHVzZXIoKSB7CiAgICByZXR1cm4gdGhpcy4kc3RvcmUuZ2V0dGVycy51c2VyOwogIH0KCiAgcHJpdmF0ZSBnZXQgZ2V0VXNlcklkKCk6IGJvb2xlYW4gewogICAgcmV0dXJuIHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0VXNlcklkOwogIH0KCiAgcHJpdmF0ZSBnZXQgdXNlckltYWdlcygpIHsKICAgIHJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLnVzZXJJbWFnZTsKICB9CgogIHByaXZhdGUgc2VsZWN0RmlsZSgpOiB2b2lkIHsKICAgIGNvbnN0IHsgZmlsZXMgfSA9IHRoaXMuJHJlZnMuZmlsZXM7CiAgICB0aGlzLnVwbG9hZEZpbGVzID0gWy4uLnRoaXMuZmlsZXMsIC4uLmZpbGVzXTsKCiAgICB0aGlzLmZpbGVzID0gWwogICAgICAuLi50aGlzLmZpbGVzLAogICAgICAuLi5fLm1hcChmaWxlcywgKGZpbGUpID0+ICh7CiAgICAgICAgbmFtZTogZmlsZS5uYW1lLAogICAgICAgIHNpemU6IGZpbGUuc2l6ZSwKICAgICAgICB0eXBlOiBmaWxlLnR5cGUsCiAgICAgICAgdXJsOiBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpLAogICAgICAgIGludmFsaWRNZXNzYWdlOiB0aGlzLnZhbGlkYXRlRmlsZShmaWxlKSwKICAgICAgfSkpLAogICAgXTsKICB9CgogIHByaXZhdGUgdmFsaWRhdGVGaWxlKGZpbGUpOiBTdHJpbmcgewogICAgY29uc3QgTUFYX1NJWkUgPSAyMDAwMDAwMDsKICAgIGNvbnN0IGFsbG93ZWRUeXBlcyA9IFsnaW1hZ2UvanBlZycsICdpbWFnZS9wbmcnLCAnaW1hZ2UvZ2lmJ107CgogICAgaWYgKGZpbGUuc2l6ZSA+IE1BWF9TSVpFKSB7CiAgICAgIHJldHVybiBgbWF4IHNpemU6ICR7TUFYX1NJWkUgLyAxMDB9a2JgOwogICAgfQoKICAgIGlmICghYWxsb3dlZFR5cGVzLmluY2x1ZGVzKGZpbGUudHlwZSkpIHsKICAgICAgcmV0dXJuICdQbGVhc2UgdXNlIG9ubHkgLmpwZywgLnBuZyBvciAuZ2lmIGZpbGUgdHlwZXMnOwogICAgfQoKICAgIHJldHVybiAnJzsKICB9CgogIHByaXZhdGUgYXN5bmMgc2VuZEZpbGUoKTogUHJvbWlzZTx2b2lkPiB7CiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgdGhpcy51cGxvYWRGaWxlcy51c2VySWQgPSB0aGlzLmdldFVzZXJJZDsKICAgIF8uZm9yRWFjaCh0aGlzLnVwbG9hZEZpbGVzLCAoZmlsZSkgPT4gewogICAgICBpZiAodGhpcy52YWxpZGF0ZUZpbGUoZmlsZSkgPT09ICcnKSB7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlcycsIGZpbGUpOwogICAgICB9CiAgICB9KTsKICAgIHRyeSB7CiAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCd1cGxvYWQnLCBmb3JtRGF0YSk7CiAgICAgIHRoaXMubWVzc2FnZSA9ICdGaWxlcyB1cGxvYWRlZCc7CiAgICAgIHRoaXMuZmlsZXMgPSBbXTsKICAgICAgdGhpcy51cGxvYWRGaWxlcyA9IFtdOwogICAgICB0aGlzLmdyYWJUb2tlbkFuZFVzZXJEYXRhKCk7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgY29uc29sZS5sb2coZXJyLCAnZXJyJyk7CiAgICAgIHRoaXMubWVzc2FnZSA9ICdFcnJvcic7CiAgICB9CiAgfQoKICBkZWxldGVJbWFnZShpZCk6IHZvaWQgewogICAgdGhpcy5kZWxldGVJbWFnZUlkLnB1c2goaWQpOwogIH0KCiAgYXN5bmMgc2F2ZURlbGV0ZWRJbWFnZXMoKTogUHJvbWlzZTx2b2lkPiB7CiAgICBjb25zdCBwYXlsb2FkID0gewogICAgICBpbWFnZUlkczogdGhpcy5kZWxldGVJbWFnZUlkLAogICAgICB1c2VySWQ6IHRoaXMuZ2V0VXNlcklkLAogICAgfTsKICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdkZWxldGVJbWFnZXMnLCBwYXlsb2FkKTsKICAgIHRoaXMuZGVsZXRlSW1hZ2VJZCA9IFtdOwogIH0KCiAgcHJpdmF0ZSBncmFiVG9rZW5BbmRVc2VyRGF0YSgpOiB2b2lkIHsKICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKCdmZXRjaFVzZXJEYXRhJyk7CiAgfQoKICBwcml2YXRlIGNyZWF0ZWQoKTogdm9pZCB7CiAgICB0aGlzLmdyYWJUb2tlbkFuZFVzZXJEYXRhKCk7CiAgfQoKICBwcml2YXRlIGRlc3Ryb3koKTogdm9pZCB7CiAgICB0aGlzLmRlbGV0ZUltYWdlSWQgPSBbXTsKICB9Cn0K"},{"version":3,"sources":["Profile.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4FA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Profile.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"profile view\">\n    <h1>Hamlin Halloween Pumpkin Upload</h1>\n    <b-tabs>\n        <b-tab title=\"Upload Pumpkins\">\n          <form\n              @submit.prevent=\"sendFile\"\n              enctype=\"multipart/form-data\"\n            >\n              <div class=\"field\">\n                <div class=\"file is-boxed is-primary\">\n                  <label class=\"file-label\">\n                      <input\n                        multiple\n                        type=\"file\"\n                        class=\"file-input\"\n                        ref=\"files\"\n                        @change=\"selectFile\"\n                      />\n                  </label>\n                </div>\n              </div>\n              <template\n                  v-for=\"(file, index) in files\"\n                >\n                <div\n                  class=\"image-container\"\n                  :key=\"index\"\n                >\n                  <img\n                    :src=\"file.url\"\n                  />\n                  <div\n                    :id=\"`tooltip-target-${index}`\"\n                    class=\"delete\"\n                    @click.prevent=\"\n                      files.splice(index, 1);\n                      uploadFiles.splice(index, 1)\"\n                  > <b-icon icon=\"x-circle-fill\" />\n                  <b-tooltip :target=\"`tooltip-target-${index}`\" triggers=\"hover\">\n                        Delete\n                  </b-tooltip>\n                  </div>\n                  <span\n                    v-if=\"file.invalidMessage\"\n                    style=\"color:red\">\n                    {{ file.invalidMessage }}\n                  </span>\n                </div>\n              </template>\n              <div class=\"field\">\n                <b-button\n                  type=\"submit\"\n                  variant=\"primary\"\n                >\n                  Upload\n                </b-button>\n                <p>{{ this.message }}</p>\n              </div>\n              </form>\n        </b-tab>\n\n        <b-tab title=\"Your Pumpkin Images\" lazy>\n              <b-button\n                type=\"submit\"\n                variant=\"primary\"\n                :disabled=\"!deleteImageId.length > 0\"\n                @click.prevent=\"saveDeletedImages()\"\n              >\n              Delete Selected Images {{ deleteImageId.length || '' }}\n              </b-button>\n\n            <template v-for=\"(image, index) in userImages\">\n                <div\n                  class=\"image-container\"\n                  :key=\"index\"\n                >\n                <img :src=\"`http://localhost:2121/${image.image_name}`\" />\n                <div\n                  class=\"delete\"\n                  @click.prevent=\"userImages.splice(index, 1);deleteImage(image.id);\"><b-icon icon=\"x-circle-fill\" />\n                </div>\n                </div>\n            </template>\n        </b-tab>\n\n      </b-tabs>\n\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\nimport _ from 'lodash';\n\n@Component\nexport default class Profile extends Vue {\n\n  private files = [];\n\n  private uploadFiles = [];\n\n  private message = '';\n\n  private imgURL = [];\n\n  private yourImages = [];\n\n  private deleteImageId = [];\n\n  private get user() {\n    return this.$store.getters.user;\n  }\n\n  private get getUserId(): boolean {\n    return this.$store.getters.getUserId;\n  }\n\n  private get userImages() {\n    return this.$store.getters.userImage;\n  }\n\n  private selectFile(): void {\n    const { files } = this.$refs.files;\n    this.uploadFiles = [...this.files, ...files];\n\n    this.files = [\n      ...this.files,\n      ..._.map(files, (file) => ({\n        name: file.name,\n        size: file.size,\n        type: file.type,\n        url: URL.createObjectURL(file),\n        invalidMessage: this.validateFile(file),\n      })),\n    ];\n  }\n\n  private validateFile(file): String {\n    const MAX_SIZE = 20000000;\n    const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];\n\n    if (file.size > MAX_SIZE) {\n      return `max size: ${MAX_SIZE / 100}kb`;\n    }\n\n    if (!allowedTypes.includes(file.type)) {\n      return 'Please use only .jpg, .png or .gif file types';\n    }\n\n    return '';\n  }\n\n  private async sendFile(): Promise<void> {\n    const formData = new FormData();\n    this.uploadFiles.userId = this.getUserId;\n    _.forEach(this.uploadFiles, (file) => {\n      if (this.validateFile(file) === '') {\n        formData.append('files', file);\n      }\n    });\n    try {\n      await this.$store.dispatch('upload', formData);\n      this.message = 'Files uploaded';\n      this.files = [];\n      this.uploadFiles = [];\n      this.grabTokenAndUserData();\n    } catch (err) {\n      console.log(err, 'err');\n      this.message = 'Error';\n    }\n  }\n\n  deleteImage(id): void {\n    this.deleteImageId.push(id);\n  }\n\n  async saveDeletedImages(): Promise<void> {\n    const payload = {\n      imageIds: this.deleteImageId,\n      userId: this.getUserId,\n    };\n    await this.$store.dispatch('deleteImages', payload);\n    this.deleteImageId = [];\n  }\n\n  private grabTokenAndUserData(): void {\n    this.$store.dispatch('fetchUserData');\n  }\n\n  private created(): void {\n    this.grabTokenAndUserData();\n  }\n\n  private destroy(): void {\n    this.deleteImageId = [];\n  }\n}\n</script>\n\n<style lang=\"scss\">\n  .profile {\n    margin-top: 20px;\n\n    h1 {\n      color: #fa9b03;\n    }\n  }\n\n  .nav-tabs .nav-link {\n    color: #fa9b03;\n  }\n  .nav-tabs .nav-link.active, .nav-tabs .nav-item.show .nav-link {\n    color: black;\n    background-color: #fa9b03;\n  }\n\n  .tab-content {\n    background: #fa9b03;\n    padding: 20px;\n    margin: 0;\n    border-radius: 5px;\n    border-top-right-radius: 0;\n    border-top-left-radius: 0;\n  }\n\n  .image-container {\n    position: relative;\n    max-width: 300px;\n    margin-bottom: 20px;\n    z-index: 10;\n    img {\n      max-width: 300px;\n      border-radius: 5px;\n    }\n\n    .delete {\n      position: absolute;\n      right: -6px;\n      top: -9px;\n      background: red;\n      border-radius: 50%;\n      width: 30px;\n      height: 30px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      cursor: pointer;\n    }\n  }\n</style>\n"]}]}